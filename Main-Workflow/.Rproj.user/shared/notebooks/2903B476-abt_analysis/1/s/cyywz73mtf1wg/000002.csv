"0","# Finding Best PCA with for loop"
"0","a <- seq(250, 1000, by=50)"
"0","b <- c()"
"0","for (i in a){"
"0","  set.seed(123)"
"0","  sce_PCA<-RankPCAGenes(sce_sampling, top = i)"
"0","  keep_PCA<-rowData(sce_PCA)[,""PCAGenes""]"
"0","  sce_PCA<-sce_PCA[keep_PCA, ]"
"0","  sce_cluster<-Cluster(sce_PCA, use.subsamples = TRUE, method = ""louvian"", k_nn = 10, conf = 0.75)"
"0","  clusterIDs <- colData(sce_cluster)[,""Sample_ClusterIDs""]"
"0","  data <- matrix(counts(sce_cluster),nrow = length(clusterIDs))"
"0","  Dist <- dist(data,method=""euclidean"")"
"0","  x <- dunn(clusters=as.vector(clusterIDs),distance = Dist)"
"0","  b <- append(b,x)"
"0","}"
"1","Find best PCA components..."
"1","[1]"
"1"," 1287"
"1"," 1000"
"1","
"
"1","250"
"1"," "
"1","genes selected.
"
"1","1287"
"1"," "
"1","samples and"
"1"," "
"1","250"
"1"," "
"1","genes used for clustering.
"
"1","Build Graph with"
"1"," "
"1","1287"
"1"," "
"1","samples..."
"1","Done.
"
"1","Louvain Partitioning..."
"1","Done.
"
"1","Find nearest neighbours among sub-samples..."
"1","Done.
"
"1","Post-hoc Cluster Assignment..."
"1","Done.
"
"1","Unassigned Cells 410"
"1"," "
"1","
"
"1","Number of Predicted Clusters: 9"
"1"," "
"1","
"
"1","Find best PCA components..."
"1","[1]"
"1"," 1287"
"1"," 1000"
"1","
"
"1","300"
"1"," "
"1","genes selected.
"
"1","1287"
"1"," "
"1","samples and"
"1"," "
"1","300"
"1"," "
"1","genes used for clustering.
"
"1","Build Graph with"
"1"," "
"1","1287"
"1"," "
"1","samples..."
"1","Done.
"
"1","Louvain Partitioning..."
"1","Done.
"
"1","Find nearest neighbours among sub-samples..."
"1","Done.
"
"1","Post-hoc Cluster Assignment..."
"1","Done.
"
"1","Unassigned Cells 355"
"1"," "
"1","
"
"1","Number of Predicted Clusters: 8"
"1"," "
"1","
"
"1","Find best PCA components..."
"1","[1]"
"1"," 1287"
"1"," 1000"
"1","
"
"1","350"
"1"," "
"1","genes selected.
"
"1","1287"
"1"," "
"1","samples and"
"1"," "
"1","350"
"1"," "
"1","genes used for clustering.
"
"1","Build Graph with"
"1"," "
"1","1287"
"1"," "
"1","samples..."
"1","Done.
"
"1","Louvain Partitioning..."
"1","Done.
"
"1","Find nearest neighbours among sub-samples..."
"1","Done.
"
"1","Post-hoc Cluster Assignment..."
"1","Done.
"
"1","Unassigned Cells 372"
"1"," "
"1","
"
"1","Number of Predicted Clusters: 8"
"1"," "
"1","
"
"1","Find best PCA components..."
"1","[1]"
"1"," 1287"
"1"," 1000"
"1","
"
"1","400"
"1"," "
"1","genes selected.
"
"1","1287"
"1"," "
"1","samples and"
"1"," "
"1","400"
"1"," "
"1","genes used for clustering.
"
"1","Build Graph with"
"1"," "
"1","1287"
"1"," "
"1","samples..."
"1","Done.
"
"1","Louvain Partitioning..."
"1","Done.
"
"1","Find nearest neighbours among sub-samples..."
"1","Done.
"
"1","Post-hoc Cluster Assignment..."
"1","Done.
"
"1","Unassigned Cells 408"
"1"," "
"1","
"
"1","Number of Predicted Clusters: 8"
"1"," "
"1","
"
"1","Find best PCA components..."
"1","[1]"
"1"," 1287"
"1"," 1000"
"1","
"
"1","450"
"1"," "
"1","genes selected.
"
"1","1287"
"1"," "
"1","samples and"
"1"," "
"1","450"
"1"," "
"1","genes used for clustering.
"
"1","Build Graph with"
"1"," "
"1","1287"
"1"," "
"1","samples..."
"1","Done.
"
"1","Louvain Partitioning..."
"1","Done.
"
"1","Find nearest neighbours among sub-samples..."
"1","Done.
"
"1","Post-hoc Cluster Assignment..."
"1","Done.
"
"1","Unassigned Cells 459"
"1"," "
"1","
"
"1","Number of Predicted Clusters: 8"
"1"," "
"1","
"
"1","Find best PCA components..."
"1","[1]"
"1"," 1287"
"1"," 1000"
"1","
"
"1","500"
"1"," "
"1","genes selected.
"
"1","1287"
"1"," "
"1","samples and"
"1"," "
"1","500"
"1"," "
"1","genes used for clustering.
"
"1","Build Graph with"
"1"," "
"1","1287"
"1"," "
"1","samples..."
"1","Done.
"
"1","Louvain Partitioning..."
"1","Done.
"
"1","Find nearest neighbours among sub-samples..."
"1","Done.
"
"1","Post-hoc Cluster Assignment..."
"1","Done.
"
"1","Unassigned Cells 406"
"1"," "
"1","
"
"1","Number of Predicted Clusters: 8"
"1"," "
"1","
"
"1","Find best PCA components..."
"1","[1]"
"1"," 1287"
"1"," 1000"
"1","
"
"1","550"
"1"," "
"1","genes selected.
"
"1","1287"
"1"," "
"1","samples and"
"1"," "
"1","550"
"1"," "
"1","genes used for clustering.
"
"1","Build Graph with"
"1"," "
"1","1287"
"1"," "
"1","samples..."
"1","Done.
"
"1","Louvain Partitioning..."
"1","Done.
"
"1","Find nearest neighbours among sub-samples..."
"1","Done.
"
"1","Post-hoc Cluster Assignment..."
"1","Done.
"
"1","Unassigned Cells 437"
"1"," "
"1","
"
"1","Number of Predicted Clusters: 8"
"1"," "
"1","
"
"1","Find best PCA components..."
"1","[1]"
"1"," 1287"
"1"," 1000"
"1","
"
"1","600"
"1"," "
"1","genes selected.
"
"1","1287"
"1"," "
"1","samples and"
"1"," "
"1","600"
"1"," "
"1","genes used for clustering.
"
"1","Build Graph with"
"1"," "
"1","1287"
"1"," "
"1","samples..."
"1","Done.
"
"1","Louvain Partitioning..."
"1","Done.
"
"1","Find nearest neighbours among sub-samples..."
"1","Done.
"
"1","Post-hoc Cluster Assignment..."
"1","Done.
"
"1","Unassigned Cells 397"
"1"," "
"1","
"
"1","Number of Predicted Clusters: 8"
"1"," "
"1","
"
"1","Find best PCA components..."
"1","[1]"
"1"," 1287"
"1"," 1000"
"1","
"
"1","650"
"1"," "
"1","genes selected.
"
"1","1287"
"1"," "
"1","samples and"
"1"," "
"1","650"
"1"," "
"1","genes used for clustering.
"
"1","Build Graph with"
"1"," "
"1","1287"
"1"," "
"1","samples..."
"1","Done.
"
"1","Louvain Partitioning..."
"1","Done.
"
"1","Find nearest neighbours among sub-samples..."
"1","Done.
"
"1","Post-hoc Cluster Assignment..."
"1","Done.
"
"1","Unassigned Cells 429"
"1"," "
"1","
"
"1","Number of Predicted Clusters: 8"
"1"," "
"1","
"
"1","Find best PCA components..."
"1","[1]"
"1"," 1287"
"1"," 1000"
"1","
"
"1","700"
"1"," "
"1","genes selected.
"
"1","1287"
"1"," "
"1","samples and"
"1"," "
"1","700"
"1"," "
"1","genes used for clustering.
"
"1","Build Graph with"
"1"," "
"1","1287"
"1"," "
"1","samples..."
"1","Done.
"
"1","Louvain Partitioning..."
"1","Done.
"
"1","Find nearest neighbours among sub-samples..."
"1","Done.
"
"1","Post-hoc Cluster Assignment..."
"1","Done.
"
"1","Unassigned Cells 475"
"1"," "
"1","
"
"1","Number of Predicted Clusters: 8"
"1"," "
"1","
"
"1","Find best PCA components..."
"1","[1]"
"1"," 1287"
"1"," 1000"
"1","
"
"1","750"
"1"," "
"1","genes selected.
"
"1","1287"
"1"," "
"1","samples and"
"1"," "
"1","750"
"1"," "
"1","genes used for clustering.
"
"1","Build Graph with"
"1"," "
"1","1287"
"1"," "
"1","samples..."
"1","Done.
"
"1","Louvain Partitioning..."
"1","Done.
"
"1","Find nearest neighbours among sub-samples..."
"1","Done.
"
"1","Post-hoc Cluster Assignment..."
"1","Done.
"
"1","Unassigned Cells 498"
"1"," "
"1","
"
"1","Number of Predicted Clusters: 8"
"1"," "
"1","
"
"1","Find best PCA components..."
"1","[1]"
"1"," 1287"
"1"," 1000"
"1","
"
"1","800"
"1"," "
"1","genes selected.
"
"1","1287"
"1"," "
"1","samples and"
"1"," "
"1","800"
"1"," "
"1","genes used for clustering.
"
"1","Build Graph with"
"1"," "
"1","1287"
"1"," "
"1","samples..."
"1","Done.
"
"1","Louvain Partitioning..."
"1","Done.
"
"1","Find nearest neighbours among sub-samples..."
"1","Done.
"
"1","Post-hoc Cluster Assignment..."
"1","Done.
"
"1","Unassigned Cells 490"
"1"," "
"1","
"
"1","Number of Predicted Clusters: 8"
"1"," "
"1","
"
"1","Find best PCA components..."
"1","[1]"
"1"," 1287"
"1"," 1000"
"1","
"
"1","850"
"1"," "
"1","genes selected.
"
"1","1287"
"1"," "
"1","samples and"
"1"," "
"1","850"
"1"," "
"1","genes used for clustering.
"
"1","Build Graph with"
"1"," "
"1","1287"
"1"," "
"1","samples..."
"1","Done.
"
"1","Louvain Partitioning..."
"1","Done.
"
"1","Find nearest neighbours among sub-samples..."
"1","Done.
"
"1","Post-hoc Cluster Assignment..."
"1","Done.
"
"1","Unassigned Cells 384"
"1"," "
"1","
"
"1","Number of Predicted Clusters: 6"
"1"," "
"1","
"
"1","Find best PCA components..."
"1","[1]"
"1"," 1287"
"1"," 1000"
"1","
"
"1","900"
"1"," "
"1","genes selected.
"
"1","1287"
"1"," "
"1","samples and"
"1"," "
"1","900"
"1"," "
"1","genes used for clustering.
"
"1","Build Graph with"
"1"," "
"1","1287"
"1"," "
"1","samples..."
"1","Done.
"
"1","Louvain Partitioning..."
"1","Done.
"
"1","Find nearest neighbours among sub-samples..."
"1","Done.
"
"1","Post-hoc Cluster Assignment..."
"1","Done.
"
"1","Unassigned Cells 483"
"1"," "
"1","
"
"1","Number of Predicted Clusters: 7"
"1"," "
"1","
"
"1","Find best PCA components..."
"1","[1]"
"1"," 1287"
"1"," 1000"
"1","
"
"1","950"
"1"," "
"1","genes selected.
"
"1","1287"
"1"," "
"1","samples and"
"1"," "
"1","950"
"1"," "
"1","genes used for clustering.
"
"1","Build Graph with"
"1"," "
"1","1287"
"1"," "
"1","samples..."
"1","Done.
"
"1","Louvain Partitioning..."
"1","Done.
"
"1","Find nearest neighbours among sub-samples..."
"1","Done.
"
"1","Post-hoc Cluster Assignment..."
"1","Done.
"
"1","Unassigned Cells 435"
"1"," "
"1","
"
"1","Number of Predicted Clusters: 7"
"1"," "
"1","
"
"1","Find best PCA components..."
"1","[1]"
"1"," 1287"
"1"," 1000"
"1","
"
"1","1000"
"1"," "
"1","genes selected.
"
"1","1287"
"1"," "
"1","samples and"
"1"," "
"1","1000"
"1"," "
"1","genes used for clustering.
"
"1","Build Graph with"
"1"," "
"1","1287"
"1"," "
"1","samples..."
"1","Done.
"
"1","Louvain Partitioning..."
"1","Done.
"
"1","Find nearest neighbours among sub-samples..."
"1","Done.
"
"1","Post-hoc Cluster Assignment..."
"1","Done.
"
"1","Unassigned Cells 450"
"1"," "
"1","
"
"1","Number of Predicted Clusters: 7"
"1"," "
"1","
"
